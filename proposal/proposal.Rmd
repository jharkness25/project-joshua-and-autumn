---
title: "Project proposal: Contaminated sediments in the Gulf of Maine"
author: "Joshua Harkness and Autumn Pauly,"
date: "October 2023"
output: github_document
---

```{r load-packages, echo=FALSE, message = FALSE}
library(tidyverse)
library(broom)
library(readxl)
```

```{r load-data, echo=FALSE, message=FALSE, warning=FALSE}
stations = read_excel("/cloud/project/data/STAT2002.xls", sheet = 2, skip = 3)
sediments = read_excel("/cloud/project/data/TXTR2002.xls", sheet = 2, skip = 3)
PCBs = read_excel("/cloud/project/data/PCBP2002.xls", sheet = 2, skip = 3)
PAHs = read_excel("/cloud/project/data/PAHS2002.xls", sheet = 2, skip = 3)
organics = read_excel("/cloud/project/data/GENO2002.xls", sheet = 2, skip = 3)
inorganics = read_excel("/cloud/project/data/INOR2002.xls", sheet = 2, skip = 3)
```

## 1. Introduction
We will be looking at distributions and concentrations of contaminated sediments in the Gulf of Maine, using the Gulf of Maine Contaminated Sediments Database published by the U.S. Geological Survey in their Open-File Report 02-403.  There are seven data files in this database which we may use in some form, principally these include geographic information on stations (collection sites), textural sediments data, and contaminants data.  Each data file includes `r nrow(stations)` observations in `r ncol(organics)` to `r ncol(inorganics)` variables, respectively.  In this format, each observation represents a sediment sample; this unique ID is shared between each data file, allowing contaminant data to be associated with geographic location and other data.  Said another way, this is a database containing information on `r nrow(stations)` observations collected from the Gulf of Maine between `r min(stations$YEAR1, na.rm = T)` and `r max(stations$YEAR2, na.rm = T)` by multiple researchers as part of multiple projects.  

The database includes data on the collection of sediment samples, including geographic location, by general and specific location categories (i.e., "Boston Harbor"), when the sample was collected, and by whom.  Sediment textural data includes particle size, percent composition of sand, gravel, silt, clay, etc., along with summary statistics and distributions of particle types/sizes within each sample.  The inorganics dataset includes concentrations of many inorganic contaminents, such as lead, mercury, arsenic, cadmium, and sample radioactivity.  Organic contaminants are split between three datasets: PCBs includes numerous polychlorinated biphenyls (PCBs), cyclohexanes, and organochlorine pesticides (such as DDT, DDE, aldrin, dieldrin, etc.)  PAHs includes polycyclic hydrocarbons (PAHs), which are hydrocarbon rings (excluding benzene) common in coal and oil products.  General organic contaminants includes butyls, total concentrations of PCBs, PAHs, and pesticides, and volatility of tested samples.

Taken as a whole, this database is quite large and a comprehensive analysis of all the data it contains is unrealistic for this 5-week long project.  It is necessary to pare this database down to the components we wish to explore in the course of this project.  We are most interested in examining the relationship between sediments types and patterns of spatial distribution and concentrations of organic contaminants.  At this point, we are specifically interested in the relationships between PCBs, PAHs, organochlorine pesticides, and sediment type distribution and composition.  We are unlikely to use either the inorganic or the general organic contaminants datasets in our analysis; likewise, these are excluded from our 'Data' section below.  Since there are between `r ncol(organics)` and `r ncol(inorganics)` variables in each dataset, we will need to make extensive use of data tidying.  Many of these variables are either not relevant or not useful for our analysis; this will require us to cut down on the number of variables in each data file through subsetting and filtering to make our analysis more manageable.  Similarly, the nature of these data files is such that we will need to join multiple data files by the sample's unique ID, in order to analyze spatial distribution of contaminants and their relationship with sediment characteristics.  Filtering will probably also be useful for making direct comparisons between specific sample sites (e.g., between Frenchman Bay and Penobscot Bay).  Even by cutting out two data files from our analysis, we will still have to choose between specific variables to analyze.  At this point, we are aiming to analyze 10-15 organic contaminants of regional importance (these will include PCBs, some pesticides such as DDT and aldrin, and potentially some PAHs).  Making this analysis feasible means cutting back on what data we include in our analysis, by means of formulating specific research questions, which no doubt, will become more specific as we continue data exploration.  

As an end-goal for this project, we would like to conduct an appropriate analysis of 10-15 organic contaminants and their concentrations, spatial distributions, relationship to sediment type/composition and produce visualizations that effectively demonstrate our findings.  We will display spatial data with numerical as well as categorical data, and will need to overcome some challenges of effectively displaying highly skewed data associated with chemical concentrations.


## 2. Data
Our data files can be found in the 'data' folder in our project repository on GitHub.  They are as follows:

STAT2002.xls (stations data), TXTR2002.xls (sediment textural data), INOR2002.xls (inorganics), PCBS2002.xls (PCBs, pesticides), PAHS2002.xls (PAHs), GENO2002.xls (General organics)

A bibliography of this database can be found here: https://github.com/jharkness25/project-joshua-and-autumn/blob/main/data/GOMDBBib.doc

#### Stations data
```{r glimpse-stations, echo=FALSE}
glimpse(stations)
```

#### Sediments data
```{r glimpse-sediments, echo=FALSE}
glimpse(sediments)
```

#### PCB and pesticide data
```{r glimpse-pcb, echo=FALSE}
glimpse(PCBs)
```
#### PAH Data
```{r glimpse-pah, echo=FALSE}
glimpse(PAHs)
```



```{r stations-map, echo=FALSE, warning=FALSE}
stations %>%
  ggplot(aes(x = LONGITUDE, y = LATITUDE))+
  geom_point()+
  theme_bw()
```

Map of raw station data for Gulf of Maine, representing sediment sampling locations.  You can see the outline of the New England coast where points are dense, representing greater sampling near-shore.

```{r join-stations-organics, echo=FALSE}
StationOrganics = right_join(stations, organics, by = "UNIQUE_ID")
```
```{r filter-boston, echo=FALSE}
BostonOrganics = filter(StationOrganics, GEN_LOC_NM %in% c("BOSTON INNER HARBOR","NORTHWEST BOSTON HARBOR","CENTRAL BOSTON HARBOR"))
```


```{r pcb-box1, echo=FALSE, warning=FALSE}
BostonOrganics %>%
  ggplot(aes(x = GEN_LOC_NM, y = PCB_T_UGG))+
  geom_boxplot()
```
```{r pcb-box1-zoomed, echo=FALSE, warning=FALSE}
BostonOrganics %>%
  ggplot(aes(x = GEN_LOC_NM, y = PCB_T_UGG))+
  geom_boxplot()+
  ylim(0,7.5)
```
Mean PCB abundance (ug/g) are less than 0.5 for Boston Inner Harbor, Central Boston Harbor, and Northwest Boston Harbor, but outliers are present as high as 3000ug/g.



## 3. Ethics review

## 4. Data analysis plan



